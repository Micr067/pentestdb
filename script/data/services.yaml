######################################################################
# Pentestdb, a database for penetration test.
# Copyright (c) 2014-2015 alpha1e0
#===================================================
# 服务识别指纹定义.
######################################################################

categories:
  - os: 'Operating System'
  - server: 'web server'
  - language: 'web programing language'
  - cms: 'Content Management System'
  - middleware: 'middleware'
  - else: 'else'
service:
  - php:
      cats: language
      match:
        uri: '\.php\d*'    #匹配URL中非参数部分
        header:
          X-Powered-By: 'php'
          Set-Cookie: 'PHPSESSID'
          Server: 'php'
  - asp:
      cats: language
      match:
        uri: '\.asp'
        header:
          X-Powered-By: 'asp\.net'
          Set-Cookie: 'ASPSESSION|ASP\.NET_SessionId'
          X-AspNet-Version: '(.+)'
      implies:
        - iis
  - java:
      cats: language
      match:
        uri: '\.jsp'
        header:
          Set-Cookie: JSESSIONID
          X-Powered-By: 'servlet'
  - discuz:
      match:
        html: 'powered by discuz'
        requests:
          - '/config.inc.php': null
          - '/admincp.php': null
          - '/admin/prune.inc.php': null
          - '/robots.txt': Discuz
      cats: cms
      implies: 
        - php