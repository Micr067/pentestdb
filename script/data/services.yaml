######################################################################
# Pentestdb, a database for penetration test.
# Copyright (c) 2014-2015 alpha1e0
#===================================================
# 服务识别指纹定义.
######################################################################

categories:
  - 1: 'Operating System'
  - 2: 'Web Server'
  - 3: 'Web Programing Language'
  - 4: 'Mail Server'
  - 11: 'Content Management System'
  - 12: 'Middleware'
  - 99: 'else'
service:
  - PHP:
      cats: [3]
      match:
        uri: '\.php\d*'    #匹配URL中非参数部分
        header:
          X-Powered-By: 'php'
          Set-Cookie: 'PHPSESSID'
          Server: 'php'
  - ASP:
      cats: [3]
      match:
        uri: '\.asp'
        header:
          X-Powered-By: 'asp\.net'
          Set-Cookie: 'ASPSESSION|ASP\.NET_SessionId'
          X-AspNet-Version: '(.+)'
      implies:
        - iis
  - Java:
      cats: [3]
      match:
        uri: '\.jsp'
        header:
          Set-Cookie: JSESSIONID
          X-Powered-By: 'servlet'
  - IIS:
      cats: [2]
      match:
        header:
          Server: iis
  - Apache:
      cats: [2]
      match:
        header:
          Server: apache|httpd
  - Nginx:
      cats: [2]
      match:
        header:
          Server: nginx
  - lighttpd:
      cats: [2]
      match:
        header:
          Server: lighttpd
  - Tomcat:
      cats: [2]
      implies: [Java]
      match:
        header:
          Server: Apache-Coyote
          X-Powered-By: tomcat
  - Jboss:
      cats: [2]
      implies: [Java]
      match:
        header:
          X-Powered-By: 'JBoss'
  - Resin:
      cats: [2]
      implies: [Java]
      match:
        header:
          Server: resin
  - GlassFish:
      cats: [2]
      implies: [Java]
      match:
        header:
          Server: 'GlassFish'
  - discuz:
      cats: [11]
      match:
        html: 'powered by discuz'
        requests:
          - '/config.inc.php': null
          - '/admincp.php': null
          - '/admin/prune.inc.php': null
          - '/robots.txt': Discuz
      implies: [PHP]