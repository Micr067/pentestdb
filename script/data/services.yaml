######################################################################
# Pentestdb, a database for penetration test.
# Copyright (c) 2014-2015 alpha1e0
#===================================================
# 服务识别指纹定义.
######################################################################

categories:
  - 1: 'Operating System'
  - 2: 'Web Server'
  - 3: 'Web Programing Language'
  - 4: 'Mail Server'
  - 11: 'Content Management System'
  - 12: 'Middleware'
  - 99: 'else'
service:
  - PHP:
      cats: [3]
      match:
        uri: '\.php\d*'    #匹配URL中非参数部分
        header:
          X-Powered-By: 'php'
          Set-Cookie: 'PHPSESSID'
          Server: 'php'
  - ASP:
      cats: [3]
      match:
        uri: '\.asp'
        header:
          X-Powered-By: 'asp\.net'
          Set-Cookie: 'ASPSESSION|ASP\.NET_SessionId'
          X-AspNet-Version: '(.+)'
      implies:
        - iis
  - Java:
      cats: [3]
      match:
        uri: '\.jsp'
        header:
          Set-Cookie: JSESSIONID
          X-Powered-By: 'servlet'
  - IIS:
      cats: [2]
      match:
        header:
          Server: iis
  - Apache:
      cats: [2]
      match:
        header:
          Server: apache|httpd
  - Nginx:
      cats: [2]
      match:
        header:
          Server: nginx
  - lighttpd:
      cats: [2]
      match:
        header:
          Server: lighttpd
  - Tomcat:
      cats: [2]
      implies: [Java]
      match:
        header:
          Server: Apache-Coyote
          X-Powered-By: tomcat
  - Jboss:
      cats: [2]
      implies: [Java]
      match:
        header:
          X-Powered-By: 'JBoss'
  - Resin:
      cats: [2]
      implies: [Java]
      match:
        header:
          Server: resin
  - GlassFish:
      cats: [2]
      implies: [Java]
      match:
        header:
          Server: 'GlassFish'
  - Discuz:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by discuz'
        requests:
          - '/config.inc.php': null
          - '/admincp.php': null
          - '/admin/prune.inc.php': null
          - '/robots.txt': Discuz
  - DiscuzX:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by DiscuzX'
        requests:
          - '/config/config_global_default.php': null
          - '/api/manyou/my.php': null
          - '/uc_server/avatar.php': null
          - '/robots.txt': Discuz
  - DedeCMS:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by DedeCMS'
        requests:
          - '/dede/config.php': null
          - '/dede/co-view.php': null
  - EmpireCMS:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by EmpireCMS'
        requests:
          - '/e/admin/AddInfoC.php': null
          - '/robots.txt': EmpireCMS
  - PHPCMS:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by PHPCMS'
        requests:
          - '/admin/database.inc.php': null
          - '/admin/templates/admin_edit.tpl.php': null
  - PHPCMS9:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by PHPCMS9'
        requests:
          - '/phpcms/base.php': null
          - '/robots.txt': PHPCMS
  - PHPWind:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by PHPWind'
        requests:
          - '/hack.php': null
          - '/hitcache.php': null
          - '/hack/bank/admin.php': null
          - '/hack/bankset.php': null
          - '/robots.txt': PHPWIND
  - PHPWind9:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by PHPWind'
        requests:
          - '/aCloud/index.html': null
          - '/windid.php': null
          - '/windid/admin.php': null
  - QiboCMS:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by QiboCMS'
        requests:
          - '/php168/config.php': null
          - '/a_d/a_d_s.php': null
  - WordPress:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by WordPress'
        requests:
          - '/wp-config.php': null
          - '/wp-admin/admin.php': null
  - Drupal:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by Drupal'
        requests:
          - '/sites/default/settings.php': null
          - '/misc/druplicon.png': null
          - '/node#overlay=admin/dashboard': null
  - Joomla:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by Joomla'
        requests:
          - '/configuration.php': null
          - '/administrator/components/com_admin/admin.php': null
          - '/joomla.xml': null