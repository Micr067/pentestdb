######################################################################
# Pentestdb, a database for penetration test.
# Copyright (c) 2014-2015 alpha1e0
#===================================================
# 服务识别指纹定义.
######################################################################

categories:
  - 1: 
    OS: 'Operating System'
  - 2: 
    Server: 'Web Server'
  - 3: 
    Language: 'Web Programing Language'
  - 11: 
    Apps: 'Application Type'
  - 12: 
    Middleware: 'Middleware'
  - 99: 
    Else: 'Else'
applications:
  - PHP:
      cats: [3]
      match:
        uri: '\.php\d*'    #匹配URL中非参数部分
        headers:
          X-Powered-By: 'PHP/?([\d.]+)?'
          Set-Cookie: 'PHPSESSID'
          Server: 'PHP/?([\d.]+)?'
  - ASP:
      cats: [3]
      match:
        uri: '\.asp'
        headers:
          X-Powered-By: 'ASP\.NET'
          Set-Cookie: 'ASPSESSION|ASP\.NET_SessionId'
          X-AspNet-Version: '(.+)'
      implies: [IIS]
  - Java:
      cats: [3]
      match:
        uri: '\.jsp'
        headers:
          Set-Cookie: JSESSIONID
          X-Powered-By: 'Servlet(?:.([\d.]+))?'
  - IIS:
      cats: [2]
      match:
        headers:
          Server: 'IIS(?:/([\d.]+))?'
  - Apache:
      cats: [2]
      match:
        headers:
          Server: '(?:Apache(?:/([\\d.]+)))|HTTPD'
  - Nginx:
      cats: [2]
      match:
        headers:
          Server: 'nginx(?:/([\d.]+))'
  - lighttpd:
      cats: [2]
      match:
        headers:
          Server: 'lighttpd(?:/([\d.]+))'
  - Tomcat:
      cats: [2]
      implies: [Java]
      match:
        headers:
          Server: 'Apache-Coyote(/1\.1)?'
          X-Powered-By: 'Tomcat\b(?:-([\\d.]+))?'
  - Jboss:
      cats: [2]
      implies: [Java]
      match:
        headers:
          X-Powered-By: 'JBoss(?:-([\d.]+))?'
  - Jboss Web:
      cats: [2]
      implies: [Java]
      match:
        headers:
          X-Powered-By: 'JBossWeb(?:-([\d.]+))'
  - Resin:
      cats: [2]
      implies: [Java]
      match:
        headers:
          Server: 'Resin(?:/(\S*))?'
  - GlassFish:
      cats: [2]
      implies: [Java]
      match:
        headers:
          Server: 'GlassFish(?: Server)?(?: Open Source Edition)?(?: ?/?([\d.]+))?'
  - Discuz:
      cats: [11]
      implies: [PHP]
      match:
        html:
          - 'content="Discuz! X([\d\.]+)"'
          - 'Powered by discuz'
        requests:
          - '/config.inc.php'
          - '/admincp.php'
          - '/admin/prune.inc.php'
        robots: Discuz
  - DiscuzX:
      cats: [11]
      implies: [PHP]
      match:
        html:
          - 'content="Discuz! X([\d\.]+)"'
          - 'Powered by.+Discuz!.+<em>X(\d\.\d)</em>'
        requests:
          - '/config/config_global_default.php'
          - '/api/manyou/my.php'
          - '/uc_server/avatar.php'
        robots: 'Discuz! X([\d\.]+)'
  - DedeCMS:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by DedeCMS'
        requests:
          - '/dede/config.php'
          - '/dede/co-view.php'
  - EmpireCMS:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by EmpireCMS'
        requests:
          - '/e/admin/AddInfoC.php'
        robots: EmpireCMS
  - PHPCMS:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by PHPCMS'
        requests:
          - '/admin/database.inc.php'
          - '/admin/templates/admin_edit.tpl.php'
  - PHPCMS9:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by PHPCMS9'
        requests:
          - '/phpcms/base.php'
        robots: PHPCMS
  - PHPWind:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by PHPWind'
        requests:
          - '/hack.php'
          - '/hitcache.php'
          - '/hack/bank/admin.php'
          - '/hack/bankset.php'
        robots: PHPWIND
  - PHPWind9:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by PHPWind'
        requests:
          - '/aCloud/index.html'
          - '/windid.php'
          - '/windid/admin.php'
  - QiboCMS:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by QiboCMS'
        requests:
          - '/php168/config.php'
          - '/a_d/a_d_s.php'
  - WordPress:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by WordPress'
        requests:
          - '/wp-config.php'
          - '/wp-admin/admin.php'
  - Drupal:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by Drupal'
        requests:
          - '/sites/default/settings.php'
          - '/misc/druplicon.png'
          - '/node#overlay=admin/dashboard'
  - Joomla:
      cats: [11]
      implies: [PHP]
      match:
        html: 'powered by Joomla'
        requests:
          - '/configuration.php'
          - '/administrator/components/com_admin/admin.php'
          - '/joomla.xml'